<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th∆∞ Vi·ªán Moodoo - V√πng ƒê·∫•t C·∫£m X√∫c</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #f9a825;
            --vd1: #8bc34a; /* M√†u xanh l√° cho V√πng 1 */
            --vd2: #e91e63; /* M√†u h·ªìng cho V√πng 2 */
            --bg-light: #fdfdfd;
        }

        body { font-family: 'Fredoka', sans-serif; margin: 0; background: var(--bg-light); color: #333; }
        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        
        /* Header & Auth */
        header { background: var(--primary); color: white; padding: 15px 0; text-align: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .user-info { margin-top: 10px; font-size: 0.9em; }
        .btn-auth { background: white; color: var(--primary); border: none; padding: 8px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; margin: 5px; }

        /* Locked / Unlocked display */
        .not-logged-in .locked-content { display: none; }
        .not-logged-in .welcome-msg { display: block; text-align: center; padding: 100px 20px; }
        .is-logged-in .welcome-msg { display: none; }
        .is-logged-in .locked-content { display: block; }

        /* V√πng ƒë·∫•t Section */
        .video-section { padding: 40px 0; display: none; border-radius: 30px; margin-bottom: 30px; background: white; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .section-header { text-align: center; margin-bottom: 30px; }
        .section-header h2 { font-size: 2.2em; margin-bottom: 10px; }

        /* Video Grid */
        .video-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .video-card { background: #f0f0f0; border-radius: 15px; overflow: hidden; }
        .video-frame { position: relative; padding-bottom: 56.25%; height: 0; }
        .video-frame iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .video-title { padding: 15px; text-align: center; font-weight: 600; }

        /* Ebook Buttons */
        .ebook-list { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; }
        .ebook-btn { text-decoration: none; background: #fff; border: 2px solid #ddd; padding: 15px 25px; border-radius: 15px; display: flex; align-items: center; transition: 0.3s; color: inherit; }
        .ebook-btn:hover { transform: translateY(-3px); box-shadow: 0 5px 10px rgba(0,0,0,0.1); }
        .ebook-icon { font-size: 24px; margin-right: 15px; }

        /* Modal ƒêƒÉng nh·∫≠p/K√Ω */
        #authModal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
        .modal-content { background: white; width: 90%; max-width: 400px; margin: 10% auto; padding: 30px; border-radius: 20px; position: relative; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; font-family: inherit; }
        .btn-submit { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .tab-group { display: flex; margin-bottom: 20px; border-bottom: 2px solid #eee; }
        .tab-btn { flex: 1; padding: 10px; border: none; background: none; cursor: pointer; font-weight: bold; color: #999; }
        .tab-btn.active { color: var(--primary); border-bottom: 2px solid var(--primary); }

        @media (max-width: 600px) { .video-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body class="not-logged-in">

<header>
    <div class="container">
        <h1>MOODOO - TH∆Ø VI·ªÜN C·∫¢M X√öC</h1>
        <div id="authButtons">
            <button class="btn-auth" onclick="openModal('login')">ƒêƒÉng nh·∫≠p</button>
            <button class="btn-auth" onclick="openModal('register')">K√≠ch ho·∫°t m√£ s√°ch</button>
        </div>
        <div id="userAccount" style="display:none;">
            Ch√†o m·ª´ng, <span id="userNameDisplay" style="font-weight: bold;"></span>! 
            <button class="btn-auth" onclick="logout()" style="padding: 5px 12px; font-size: 0.8em;">Tho√°t</button>
        </div>
    </div>
</header>

<main class="container">
    <div class="welcome-msg">
        <img src="https://via.placeholder.com/150/FFEB3B/000000?text=Moodoo" style="border-radius: 50%;">
        <h2>Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi v√πng ƒë·∫•t c·∫£m x√∫c!</h2>
        <p>Vui l√≤ng ƒëƒÉng nh·∫≠p ho·∫∑c nh·∫≠p m√£ k√≠ch ho·∫°t ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh.</p>
    </div>

    <div class="locked-content">
        
        <section id="sectionVDCX1" class="video-section" style="border-top: 8px solid var(--vd1);">
            <div class="section-header">
                <h2 style="color: var(--vd1);">üåà V√πng ƒë·∫•t c·∫£m x√∫c 1</h2>
                <p>Kh√°m ph√° 2 t·∫≠p ƒë·∫ßu ti√™n v√† t√†i li·ªáu ƒëi k√®m</p>
            </div>
            <div class="video-grid">
                <div class="video-card">
                    <div class="video-frame"><iframe src="https://www.youtube.com/embed/jfKfPfyJRdk" allowfullscreen></iframe></div>
                    <div class="video-title">T·∫≠p 1: B√†i h√°t c·∫£m x√∫c</div>
                </div>
                <div class="video-card">
                    <div class="video-frame"><iframe src="https://www.youtube.com/embed/36n93jvjkDs" allowfullscreen></iframe></div>
                    <div class="video-title">T·∫≠p 2: Chuy·ªán c·ªßa Moodoo</div>
                </div>
            </div>
            <div class="ebook-list">
                <a href="https://heyzine.com/flip-book/ff9c4b0aca.html" target="_blank" class="ebook-btn" style="border-color: var(--vd1);">
                    <span class="ebook-icon">üìò</span>
                    <div><strong>EBOOK 1</strong><br><small>V√πng ƒë·∫•t c·∫£m x√∫c</small></div>
                </a>
                <a href="https://heyzine.com/flip-book/21a955ab12.html" target="_blank" class="ebook-btn">
                    <span class="ebook-icon">üìí</span>
                    <div><strong>S·ªî TAY</strong><br><small>D√†nh cho ba m·∫π</small></div>
                </a>
            </div>
        </section>

        <section id="sectionVDCX2" class="video-section" style="border-top: 8px solid var(--vd2);">
            <div class="section-header">
                <h2 style="color: var(--vd2);">üå∏ V√πng ƒë·∫•t c·∫£m x√∫c 2</h2>
                <p>Kh√°m ph√° 2 t·∫≠p ti·∫øp theo v√† t√†i li·ªáu ƒëi k√®m</p>
            </div>
            <div class="video-grid">
                <div class="video-card">
                    <div class="video-frame"><iframe src="https://www.youtube.com/embed/tgbNymZ7vqY" allowfullscreen></iframe></div>
                    <div class="video-title">T·∫≠p 3: Nh·∫£y c√πng Moodoo</div>
                </div>
                <div class="video-card">
                    <div class="video-frame"><iframe src="https://www.youtube.com/embed/jfKfPfyJRdk" allowfullscreen></iframe></div>
                    <div class="video-title">T·∫≠p 4: Nh·ªØng ng∆∞·ªùi b·∫°n m·ªõi</div>
                </div>
            </div>
            <div class="ebook-list">
                <a href="https://heyzine.com/flip-book/efcdb035f9.html" target="_blank" class="ebook-btn" style="border-color: var(--vd2);">
                    <span class="ebook-icon">üìô</span>
                    <div><strong>EBOOK 2</strong><br><small>H√†nh tr√¨nh m·ªõi</small></div>
                </a>
                <a href="https://heyzine.com/flip-book/21a955ab12.html" target="_blank" class="ebook-btn">
                    <span class="ebook-icon">üìí</span>
                    <div><strong>S·ªî TAY</strong><br><small>D√†nh cho ba m·∫π</small></div>
                </a>
            </div>
        </section>

    </div>
</main>

<div id="authModal">
    <div class="modal-content">
        <span onclick="closeModal()" style="position:absolute; right:15px; top:10px; cursor:pointer; font-size:24px;">&times;</span>
        <div class="tab-group">
            <button id="tabLogin" class="tab-btn" onclick="switchTab('login')">ƒêƒÇNG NH·∫¨P</button>
            <button id="tabRegister" class="tab-btn" onclick="switchTab('register')">K√çCH HO·∫†T M√É</button>
        </div>

        <form id="loginForm" onsubmit="handleAuth(event, 'login')">
            <input type="email" id="loginEmail" placeholder="Email c·ªßa b·∫°n" required>
            <input type="password" id="loginPass" placeholder="M·∫≠t kh·∫©u" required>
            <button type="submit" class="btn-submit">V√ÄO TH∆Ø VI·ªÜN</button>
        </form>

        <form id="registerForm" style="display:none;" onsubmit="handleAuth(event, 'register')">
            <input type="text" id="regCode" placeholder="Nh·∫≠p m√£ k√≠ch ho·∫°t (VDCX...)" required>
            <input type="email" id="regEmail" placeholder="Email ƒëƒÉng k√Ω" required>
            <input type="password" id="regPass" placeholder="T·∫°o m·∫≠t kh·∫©u" required>
            <button type="submit" class="btn-submit">K√çCH HO·∫†T NGAY</button>
        </form>
    </div>
</div>

<script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbx1Yj0cZy8Td36LwN7NkSXahciNzvghP2wkqiF3Oh5dRqm451t1Rs107YC4pvCJjBit/exec";

    window.onload = function() {
        let savedUser = localStorage.getItem('moodoo_user');
        let savedAccess = localStorage.getItem('moodoo_access');
        if(savedUser) loginSuccess(savedUser, savedAccess);
    }

    function openModal(mode) { 
        document.getElementById('authModal').style.display = 'block'; 
        switchTab(mode);
    }
    function closeModal() { document.getElementById('authModal').style.display = 'none'; }
    function switchTab(mode) {
        document.getElementById('loginForm').style.display = mode === 'login' ? 'block' : 'none';
        document.getElementById('registerForm').style.display = mode === 'register' ? 'block' : 'none';
        document.getElementById('tabLogin').className = mode === 'login' ? 'tab-btn active' : 'tab-btn';
        document.getElementById('tabRegister').className = mode === 'register' ? 'tab-btn active' : 'tab-btn';
    }

    function handleAuth(e, type) {
        e.preventDefault();
        const btn = e.target.querySelector('button');
        const originalText = btn.innerText;
        btn.innerText = "ƒêang x·ª≠ l√Ω..."; btn.disabled = true;

        let data = { action: type };
        if(type === 'login') {
            data.email = document.getElementById('loginEmail').value;
            data.pass = document.getElementById('loginPass').value;
        } else {
            data.bookCode = document.getElementById('regCode').value;
            data.email = document.getElementById('regEmail').value;
            data.pass = document.getElementById('regPass').value;
        }

        fetch(scriptURL, { method: 'POST', body: JSON.stringify(data) })
        .then(res => res.json())
        .then(res => {
            if(res.result === "success") {
                loginSuccess(data.email, res.access);
                closeModal();
            } else {
                alert("L·ªói: " + res.message);
            }
        })
        .catch(err => alert("L·ªói k·∫øt n·ªëi App Script!"))
        .finally(() => { btn.innerText = originalText; btn.disabled = false; });
    }

    function loginSuccess(email, access) {
        document.body.className = 'is-logged-in';
        document.getElementById('authButtons').style.display = 'none';
        document.getElementById('userAccount').style.display = 'block';
        document.getElementById('userNameDisplay').innerText = email;
        
        localStorage.setItem('moodoo_user', email);
        localStorage.setItem('moodoo_access', access || "");

        // Hi·ªÉn th·ªã ph·∫ßn n·ªôi dung t∆∞∆°ng ·ª©ng
        document.getElementById('sectionVDCX1').style.display = (access === 'VDCX1' || access === 'ALL') ? 'block' : 'none';
        document.getElementById('sectionVDCX2').style.display = (access === 'VDCX2' || access === 'ALL') ? 'block' : 'none';
    }

    function logout() {
        localStorage.clear();
        location.reload();
    }
</script>
</body>
</html>